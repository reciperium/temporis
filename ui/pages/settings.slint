import {
    AboutSlint,
    Button,
    VerticalBox,
    ProgressIndicator,
    Spinner,
    Palette,
    StyleMetrics,
    HorizontalBox,
    LineEdit,
} from "std-widgets.slint";
import {ExternalSystem, Interval, System} from "../globals.slint";

export component Settings {
    callback navigate(page: int);

    key-handler-set := FocusScope {
        key-pressed(event) => {
            if (event.text == "b") {
                navigate(0);
            }
            accept
        }
    }

    VerticalBox {
        alignment: space-between;

        HorizontalBox {
            alignment: start;
            Button {
                icon: @image-url("../icons/left.svg");
                clicked() => {
                    navigate(0);
                }
            }
        }

        VerticalLayout {
            spacing: 5px;
            Text {
                text: "Interval duration";
            }

            HorizontalLayout {

                LineEdit {
                    placeholder-text: "Interval duration";
                    input-type: number;
                    text: ExternalSystem.focus_duration / 60;
                    width: 50%;
                    edited(text) => {
                        ExternalSystem.focus_duration = text.to-float() * 60;
                        ExternalSystem.save_focus(ExternalSystem.focus_duration);
                    }
                }
            }
        }

        VerticalLayout {
            spacing: 5px;
            Text {
                text: "Short break duration";
            }

            LineEdit {
                placeholder-text: "Short break duration";
                input-type: number;
                text: ExternalSystem.short_break_duration / 60;
                edited(text) => {
                    ExternalSystem.short_break_duration = text.to-float() * 60;
                    ExternalSystem.save_focus(ExternalSystem.short_break_duration);
                }
            }
        }

        VerticalLayout {
            spacing: 5px;
            Text {
                text: "Long break duration";
            }

            LineEdit {
                placeholder-text: "Long break duration";
                input-type: number;
                text: ExternalSystem.long_break_duration / 60;
                edited(text) => {
                    ExternalSystem.long_break_duration = text.to-float() * 60;
                    ExternalSystem.save_focus(ExternalSystem.long_break_duration);
                }
            }
        }

        VerticalLayout {
            spacing: 5px;
            Text {
                text: "Sessions before long break";
            }

            LineEdit {
                placeholder-text: "Sessions before long break";
                input-type: number;
                text: ExternalSystem.sessions;
                edited(text) => {
                    ExternalSystem.sessions = text.to-float() * 60;
                    ExternalSystem.save_focus(ExternalSystem.sessions);
                }
            }
        }
    }
}
